<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yuanqing.project.tiansu.mapper.assets.CameraMapper">

    <resultMap type="com.yuanqing.project.tiansu.domain.assets.Camera" id="BusiCameraResult">
        <result property="id"    column="ID"    />
        <result property="deviceCode"    column="DEVICE_CODE"    />
        <result property="deviceDomain"    column="DEVICE_DOMAIN"    />
        <result property="deviceName"    column="DEVICE_NAME"    />
        <result property="macAddress"    column="MAC_ADDRESS"    />
        <result property="longitude"    column="LONGITUDE"    />
        <result property="latitude"    column="LATITUDE"    />
        <result property="region"    column="REGION"    />
        <result property="createTime"    column="CREATE_TIME"    />
        <result property="updateTime"    column="UPDATE_TIME"    />
        <result property="ipAddress"    column="IP_ADDRESS"    />
        <result property="status"    column="STATUS"    />
        <result property="sipServerId"    column="SIP_SERVER_ID"    />
        <result property="deviceType"    column="DEVICE_TYPE"    />
        <result property="domainIp"    column="DOMAIN_IP"    />
        <result property="domainPort"    column="DOMAIN_PORT"    />
        <result property="isGb"    column="IS_GB"    />
        <result property="manufacturer"    column="MANUFACTURER"    />
        <result property="isProbe"    column="IS_PROBE"    />
        <result property="isImport"    column="IS_IMPORT"    />
        <result property="isCheck"    column="IS_CHECK"    />
    </resultMap>

    <sql id="selectBusiCameraVo">
        select ID, DEVICE_CODE, DEVICE_DOMAIN, DEVICE_NAME, MAC_ADDRESS, LONGITUDE, LATITUDE, REGION, CREATE_TIME, UPDATE_TIME, IP_ADDRESS, STATUS, SIP_SERVER_ID, DEVICE_TYPE, DOMAIN_IP, DOMAIN_PORT, IS_GB, MANUFACTURER, IS_PROBE, IS_IMPORT, IS_CHECK from busi_camera
    </sql>

    <select id="getList" parameterType="com.yuanqing.project.tiansu.domain.assets.Camera" resultMap="BusiCameraResult">
        <include refid="selectBusiCameraVo"/>
        <where>
            <if test="deviceCode != null  and deviceCode != ''"> and DEVICE_CODE = #{deviceCode}</if>
            <if test="deviceDomain != null  and deviceDomain != ''"> and DEVICE_DOMAIN = #{deviceDomain}</if>
            <if test="deviceName != null  and deviceName != ''"> and DEVICE_NAME like concat('%', #{deviceName}, '%')</if>
            <if test="macAddress != null  and macAddress != ''"> and MAC_ADDRESS = #{macAddress}</if>
            <if test="longitude != null "> and LONGITUDE = #{longitude}</if>
            <if test="latitude != null "> and LATITUDE = #{latitude}</if>
            <if test="region != null "> and REGION = #{region}</if>
            <if test="createTime != null "> and CREATE_TIME = #{createTime}</if>
            <if test="updateTime != null "> and UPDATE_TIME = #{updateTime}</if>
            <if test="ipAddress != null "> and IP_ADDRESS = #{ipAddress}</if>
            <if test="status != null  and status != ''"> and STATUS = #{status}</if>
            <if test="sipServerId != null "> and SIP_SERVER_ID = #{sipServerId}</if>
            <if test="deviceType != null  and deviceType != ''"> and DEVICE_TYPE = #{deviceType}</if>
            <if test="domainIp != null "> and DOMAIN_IP = #{domainIp}</if>
            <if test="domainPort != null "> and DOMAIN_PORT = #{domainPort}</if>
            <if test="isGb != null "> and IS_GB = #{isGb}</if>
            <if test="manufacturer != null  and manufacturer != ''"> and MANUFACTURER = #{manufacturer}</if>
            <if test="isProbe != null  and isProbe != ''"> and IS_PROBE = #{isProbe}</if>
            <if test="isImport != null  and isImport != ''"> and IS_IMPORT = #{isImport}</if>
            <if test="isCheck != null "> and IS_CHECK = #{isCheck}</if>
            <if test="startDate != null and endDate != null">update_time between #{startDate} and #{endDate}</if>
        </where>
    </select>

    <select id="findById" parameterType="Long" resultMap="BusiCameraResult">
        <include refid="selectBusiCameraVo"/>
        where ID = #{id}
    </select>

    <select id="gourpByGb" resultType="com.alibaba.fastjson.JSONObject">

        select is_gb type,count(*) count  from busi_camera GROUP BY IS_GB

    </select>

    <update id="updateIsNotServer" parameterType="long">
        update busi_camera
        <set>
            is_check = 1
            WHERE ip_address = #{ipAddress}
        </set>
    </update>

    <update id="changStatus">
        UPDATE BUSI_CAMERA SET STATUS= '0',UPDATE_TIME=now() WHERE ID in
        <foreach collection="array" index="index" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </update>

    <update id="changAllStatus">
        UPDATE BUSI_CAMERA SET STATUS= '0',UPDATE_TIME=now() WHERE STATUS!='0'
    </update>

    <insert id="insert" parameterType="Camera">
        insert into busi_camera
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null ">ID,</if>
            <if test="deviceCode != null  and deviceCode != ''">DEVICE_CODE,</if>
            <if test="deviceDomain != null  and deviceDomain != ''">DEVICE_DOMAIN,</if>
            <if test="deviceName != null  and deviceName != ''">DEVICE_NAME,</if>
            <if test="macAddress != null  and macAddress != ''">MAC_ADDRESS,</if>
            <if test="longitude != null ">LONGITUDE,</if>
            <if test="latitude != null ">LATITUDE,</if>
            <if test="region != null ">REGION,</if>
            <if test="createTime != null ">CREATE_TIME,</if>
            <if test="updateTime != null ">UPDATE_TIME,</if>
            <if test="ipAddress != null ">IP_ADDRESS,</if>
            <if test="status != null  and status != ''">STATUS,</if>
            <if test="sipServerId != null ">SIP_SERVER_ID,</if>
            <if test="deviceType != null  and deviceType != ''">DEVICE_TYPE,</if>
            <if test="domainIp != null ">DOMAIN_IP,</if>
            <if test="domainPort != null ">DOMAIN_PORT,</if>
            <if test="isGb != null ">IS_GB,</if>
            <if test="manufacturer != null  and manufacturer != ''">MANUFACTURER,</if>
            <if test="isProbe != null  and isProbe != ''">IS_PROBE,</if>
            <if test="isImport != null  and isImport != ''">IS_IMPORT,</if>
            <if test="isCheck != null ">IS_CHECK,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null ">#{id},</if>
            <if test="deviceCode != null  and deviceCode != ''">#{deviceCode},</if>
            <if test="deviceDomain != null  and deviceDomain != ''">#{deviceDomain},</if>
            <if test="deviceName != null  and deviceName != ''">#{deviceName},</if>
            <if test="macAddress != null  and macAddress != ''">#{macAddress},</if>
            <if test="longitude != null ">#{longitude},</if>
            <if test="latitude != null ">#{latitude},</if>
            <if test="region != null ">#{region},</if>
            <if test="createTime != null ">#{createTime},</if>
            <if test="updateTime != null ">#{updateTime},</if>
            <if test="ipAddress != null ">#{ipAddress},</if>
            <if test="status != null  and status != ''">#{status},</if>
            <if test="sipServerId != null ">#{sipServerId},</if>
            <if test="deviceType != null  and deviceType != ''">#{deviceType},</if>
            <if test="domainIp != null ">#{domainIp},</if>
            <if test="domainPort != null ">#{domainPort},</if>
            <if test="isGb != null ">#{isGb},</if>
            <if test="manufacturer != null  and manufacturer != ''">#{manufacturer},</if>
            <if test="isProbe != null  and isProbe != ''">#{isProbe},</if>
            <if test="isImport != null  and isImport != ''">#{isImport},</if>
            <if test="isCheck != null ">#{isCheck},</if>
        </trim>
    </insert>

    <update id="update" parameterType="Camera">
        update busi_camera
        <trim prefix="SET" suffixOverrides=",">
            <if test="deviceCode != null  and deviceCode != ''">DEVICE_CODE = #{deviceCode},</if>
            <if test="deviceDomain != null  and deviceDomain != ''">DEVICE_DOMAIN = #{deviceDomain},</if>
            <if test="deviceName != null  and deviceName != ''">DEVICE_NAME = #{deviceName},</if>
            <if test="macAddress != null  and macAddress != ''">MAC_ADDRESS = #{macAddress},</if>
            <if test="longitude != null ">LONGITUDE = #{longitude},</if>
            <if test="latitude != null ">LATITUDE = #{latitude},</if>
            <if test="region != null ">REGION = #{region},</if>
            <if test="createTime != null ">CREATE_TIME = #{createTime},</if>
            <if test="updateTime != null ">UPDATE_TIME = #{updateTime},</if>
            <if test="ipAddress != null ">IP_ADDRESS = #{ipAddress},</if>
            <if test="status != null  and status != ''">STATUS = #{status},</if>
            <if test="sipServerId != null ">SIP_SERVER_ID = #{sipServerId},</if>
            <if test="deviceType != null  and deviceType != ''">DEVICE_TYPE = #{deviceType},</if>
            <if test="domainIp != null ">DOMAIN_IP = #{domainIp},</if>
            <if test="domainPort != null ">DOMAIN_PORT = #{domainPort},</if>
            <if test="isGb != null ">IS_GB = #{isGb},</if>
            <if test="manufacturer != null  and manufacturer != ''">MANUFACTURER = #{manufacturer},</if>
            <if test="isProbe != null  and isProbe != ''">IS_PROBE = #{isProbe},</if>
            <if test="isImport != null  and isImport != ''">IS_IMPORT = #{isImport},</if>
            <if test="isCheck != null ">IS_CHECK = #{isCheck},</if>
        </trim>
        where ID = #{id}
    </update>

    <delete id="delete" parameterType="Long">
        delete from busi_camera where ID = #{id}
    </delete>

</mapper>
